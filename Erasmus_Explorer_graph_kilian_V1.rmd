---
title: "Erasmus Explorer"
output: html_document
---

write text here

```{r}
library(tidyverse)
df <- read.csv('Dataset_Erasmus.csv',header = TRUE,  sep = ";")
```

A bar chart showing the distribution of participants by nationality:
```{r}
df %>%
  group_by(Participant.Nationality) %>%
  summarize(Participants = sum(Participants)) %>%
  ggplot(aes(x = Participant.Nationality, y = Participants, color = Participant.Nationality)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = -50, hjust = 0.25)) +
  guides(color = FALSE)
```
A line chart showing the trend of mobility duration over time:
```{r}
df %>%
  group_by(Academic.Year) %>% summarize(mean_duration = mean(Mobility.Duration)) %>%
  ggplot(aes(x = Academic.Year, y = mean_duration)) +
  geom_col()+
  coord_flip()
```
A pie chart showing the distribution of participants by gender:
```{r}
df %>%
  group_by(Participant.Gender) %>%
  summarize(Participants = sum(Participants)) %>%
  ggplot(aes(x = "", y = Participants, fill = Participant.Gender)) +
  geom_bar(stat = "identity") +
  coord_polar(theta = "y")
```

A bar chart showing the number of participants by receiving city:
```{r}
df %>%
  group_by(Receiving.Country.Code) %>%
  summarize(Participants = sum(Participants)) %>%
  ggplot(aes(x = Receiving.Country.Code, y = Participants, color = Receiving.Country.Code)) +
  geom_col() +
  guides(color = FALSE)
```
line chart that show the evolution of participant sent by each country
```{r}
# Select the top 10 nationalities
df_top10 <- df %>%
  group_by(Sending.Country.Code) %>%
  summarize(Participant_tot = sum(Participants)) %>%
  top_n(10, Participant_tot)

# Create a dataset containing only the top 10 nationalities
df_top10_all <- df %>%
  select(everything()) %>%
  inner_join(df_top10, by = "Sending.Country.Code")

# Create the line chart
df_top10_all %>%
  group_by(Academic.Year,Sending.Country.Code) %>% 
  summarize(Participants = sum(Participants)) %>%
  ggplot(aes(x = Academic.Year, y = Participants, color = Sending.Country.Code)) +
  geom_line(aes(group = Sending.Country.Code))


```

Nombre de participant envoy√© par nations (top 10)
```{r}
data_test <- df %>%
  group_by(Sending.Country.Code) %>%
  summarize(Participant_tot = sum(Participants)) %>%
  top_n(10, Participant_tot)
data_test <- data_test[order(data_test$Participant_tot , decreasing = TRUE), ]
data_test$Sending.Country.Code <- factor(data_test$Sending.Country.Code, levels = data_test$Sending.Country.Code)
data_test %>%
  ggplot(aes(x=Sending.Country.Code, y=Participant_tot))+
  geom_point(size=3) + 
  geom_segment(aes(x=Sending.Country.Code, 
                   xend=Sending.Country.Code, 
                   y=0, 
                   yend=Participant_tot))
```

